
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../favicon.png">
      <meta name="generator" content="mkdocs-1.2.1, mkdocs-material-7.1.9">
    
    
      
        <title>On-Chain Actions - æternity Protocol</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.ca7ac06f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.f1a3b89f.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="pink">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#on-chain" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="æternity Protocol" class="md-header__button md-logo" aria-label="æternity Protocol" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            æternity Protocol
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              On-Chain Actions
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="pink"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="pink"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/aeternity/protocol/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="æternity Protocol" class="md-nav__button md-logo" aria-label="æternity Protocol" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    æternity Protocol
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/aeternity/protocol/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Communication
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Communication" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Communication
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../GOSSIP.html" class="md-nav__link">
        Gossip
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../sync/index.html" class="md-nav__link">
        Sync
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Consensus
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Consensus" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Consensus
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../consensus/index.html" class="md-nav__link">
        General
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../consensus/bitcoin-ng.html" class="md-nav__link">
        Bitcoin-NG
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../consensus/coinbase.html" class="md-nav__link">
        Coinbase
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../consensus/locking.html" class="md-nav__link">
        Locking
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        Features
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Features" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Features
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../generalized_accounts/index.html" class="md-nav__link">
        Generalized Accounts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../AENS.html" class="md-nav__link">
        Naming System
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" >
      
      <label class="md-nav__link" for="__nav_4_3">
        Oracles
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Oracles" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Oracles
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../oracles/index.html" class="md-nav__link">
        General
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../oracles/oracle_life_cycle.html" class="md-nav__link">
        Lifecycle Examples
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../oracles/oracle_state_tree.html" class="md-nav__link">
        State Tree
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../oracles/oracle_transactions.html" class="md-nav__link">
        Transactions
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" type="checkbox" id="__nav_4_4" >
      
      <label class="md-nav__link" for="__nav_4_4">
        Smart Contracts
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Smart Contracts" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Smart Contracts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../contracts/index.html" class="md-nav__link">
        General
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../contracts/events.html" class="md-nav__link">
        Events
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../contracts/contract_transactions.html" class="md-nav__link">
        Transaction Types
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../contracts/contract_state_tree.html" class="md-nav__link">
        State Tree
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4_5" type="checkbox" id="__nav_4_4_5" >
      
      <label class="md-nav__link" for="__nav_4_4_5">
        Virtual Machines
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Virtual Machines" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_4_5">
          <span class="md-nav__icon md-icon"></span>
          Virtual Machines
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../contracts/contract_vms.html" class="md-nav__link">
        General
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../contracts/aevm.html" class="md-nav__link">
        AEVM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../contracts/fate.html" class="md-nav__link">
        FATE VM
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_5" type="checkbox" id="__nav_4_5" checked>
      
      <label class="md-nav__link" for="__nav_4_5">
        State Channels
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="State Channels" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          State Channels
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        General
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          On-Chain Actions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="ON-CHAIN.html" class="md-nav__link md-nav__link--active">
        On-Chain Actions
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#establishing-a-channel" class="md-nav__link">
    Establishing a channel
  </a>
  
    <nav class="md-nav" aria-label="Establishing a channel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#channel_create" class="md-nav__link">
    channel_create
  </a>
  
    <nav class="md-nav" aria-label="channel_create">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generalized-accounts" class="md-nav__link">
    Generalized accounts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-a-channel" class="md-nav__link">
    Updating a channel
  </a>
  
    <nav class="md-nav" aria-label="Updating a channel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#channel_deposit" class="md-nav__link">
    channel_deposit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel_withdraw" class="md-nav__link">
    channel_withdraw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel_snapshot_solo" class="md-nav__link">
    channel_snapshot_solo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel_set_delegates" class="md-nav__link">
    channel_set_delegates
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#closing-a-channel" class="md-nav__link">
    Closing a channel
  </a>
  
    <nav class="md-nav" aria-label="Closing a channel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#channel_close_mutual" class="md-nav__link">
    channel_close_mutual
  </a>
  
    <nav class="md-nav" aria-label="channel_close_mutual">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements_1" class="md-nav__link">
    Requirements
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel_close_solo" class="md-nav__link">
    channel_close_solo
  </a>
  
    <nav class="md-nav" aria-label="channel_close_solo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#empty-payload" class="md-nav__link">
    Empty payload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#off-chain-transaction-payload" class="md-nav__link">
    Off-chain transaction payload
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel_settle" class="md-nav__link">
    channel_settle
  </a>
  
    <nav class="md-nav" aria-label="channel_settle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements_2" class="md-nav__link">
    Requirements
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#forcing-progress" class="md-nav__link">
    Forcing progress
  </a>
  
    <nav class="md-nav" aria-label="Forcing progress">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#channel_force_progress_tx" class="md-nav__link">
    channel_force_progress_tx
  </a>
  
    <nav class="md-nav" aria-label="channel_force_progress_tx">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#empty-payload_1" class="md-nav__link">
    Empty Payload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#off-chain-transaction-payload_1" class="md-nav__link">
    Off-chain transaction Payload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#force-progress-side-effects" class="md-nav__link">
    Force progress side effects
  </a>
  
    <nav class="md-nav" aria-label="Force progress side effects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-channel-object" class="md-nav__link">
    Updating channel object
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call-object" class="md-nav__link">
    Call object
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#disputing-updates" class="md-nav__link">
    Disputing updates
  </a>
  
    <nav class="md-nav" aria-label="Disputing updates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#force-progress-dispute-with-closing-channel" class="md-nav__link">
    Force progress dispute with closing channel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#force-progress-dispute-with-open-channel-example" class="md-nav__link">
    Force progress dispute with open channel example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#force-progress-dispute-with-closing-channel-example" class="md-nav__link">
    Force progress dispute with closing channel example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel-slash" class="md-nav__link">
    Channel slash
  </a>
  
    <nav class="md-nav" aria-label="Channel slash">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#off-chain-transaction-payload_2" class="md-nav__link">
    Off-chain transaction payload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requirements_3" class="md-nav__link">
    Requirements
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel-state-tree" class="md-nav__link">
    Channel state tree
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="OFF-CHAIN.html" class="md-nav__link">
        Off-Chain Actions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="state.html" class="md-nav__link">
        Off-Chain State
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        Node API
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Node API" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Node API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/index.html" class="md-nav__link">
        General
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/api_encoding.html" class="md-nav__link">
        Encoding
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_3" type="checkbox" id="__nav_5_3" >
      
      <label class="md-nav__link" for="__nav_5_3">
        API Usage
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API Usage" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          API Usage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/account_api_usage.html" class="md-nav__link">
        Account API
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/channels_api_usage.html" class="md-nav__link">
        Channels API
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/contract_api_usage.html" class="md-nav__link">
        Contract API
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/mining_api_usage.html" class="md-nav__link">
        Mining API
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/naming_system_api_usage.html" class="md-nav__link">
        Naming System API
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/oracle_api_usage.html" class="md-nav__link">
        Oracle API
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/spend_api_usage.html" class="md-nav__link">
        Spend API
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4" type="checkbox" id="__nav_5_4" >
      
      <label class="md-nav__link" for="__nav_5_4">
        State Channels
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="State Channels" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_4">
          <span class="md-nav__icon md-icon"></span>
          State Channels
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/channel_ws_api.html" class="md-nav__link">
        WebSocket API
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_2" type="checkbox" id="__nav_5_4_2" >
      
      <label class="md-nav__link" for="__nav_5_4_2">
        Examples
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Examples" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_4_2">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/index.html" class="md-nav__link">
        General
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_2_2" type="checkbox" id="__nav_5_4_2_2" >
      
      <label class="md-nav__link" for="__nav_5_4_2_2">
        JSON-RPC
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="JSON-RPC" data-md-level="4">
        <label class="md-nav__title" for="__nav_5_4_2_2">
          <span class="md-nav__icon md-icon"></span>
          JSON-RPC
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_2_2_1" type="checkbox" id="__nav_5_4_2_2_1" >
      
      <label class="md-nav__link" for="__nav_5_4_2_2_1">
        Abort Updates
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Abort Updates" data-md-level="5">
        <label class="md-nav__title" for="__nav_5_4_2_2_1">
          <span class="md-nav__icon md-icon"></span>
          Abort Updates
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/abort_updates/sc_ws_abort_deposit.html" class="md-nav__link">
        abort_deposit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/abort_updates/sc_ws_abort_offchain_update.html" class="md-nav__link">
        abort_offchain_update
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/abort_updates/sc_ws_abort_settle.html" class="md-nav__link">
        abort_settle
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/abort_updates/sc_ws_abort_shutdown.html" class="md-nav__link">
        abort_shutdown
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/abort_updates/sc_ws_abort_slash.html" class="md-nav__link">
        abort_slash
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/abort_updates/sc_ws_abort_snapshot_solo.html" class="md-nav__link">
        abort_snapshot_solo
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/abort_updates/sc_ws_abort_withdraw.html" class="md-nav__link">
        abort_withdraw
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/abort_updates/sc_ws_can_not_abort_while_open.html" class="md-nav__link">
        can_not_abort_while_open
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_2_2_2" type="checkbox" id="__nav_5_4_2_2_2" >
      
      <label class="md-nav__link" for="__nav_5_4_2_2_2">
        Assume Min Depth
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Assume Min Depth" data-md-level="5">
        <label class="md-nav__title" for="__nav_5_4_2_2_2">
          <span class="md-nav__icon md-icon"></span>
          Assume Min Depth
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/assume_min_depth/sc_ws_basic_open_close.html" class="md-nav__link">
        basic_open_close
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_2_2_3" type="checkbox" id="__nav_5_4_2_2_3" >
      
      <label class="md-nav__link" for="__nav_5_4_2_2_3">
        Both Sign
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Both Sign" data-md-level="5">
        <label class="md-nav__title" for="__nav_5_4_2_2_3">
          <span class="md-nav__icon md-icon"></span>
          Both Sign
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/both_sign/init_per_group.html" class="md-nav__link">
        init_per_group
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_2_2_3_2" type="checkbox" id="__nav_5_4_2_2_3_2" >
      
      <label class="md-nav__link" for="__nav_5_4_2_2_3_2">
        conflicts
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="conflicts" data-md-level="6">
        <label class="md-nav__title" for="__nav_5_4_2_2_3_2">
          <span class="md-nav__icon md-icon"></span>
          conflicts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/both_sign/conflicts/sc_ws_conflict_deposit_and_offchain_update.html" class="md-nav__link">
        conflict_deposit_and_offchain_update
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/both_sign/conflicts/sc_ws_conflict_two_deposits.html" class="md-nav__link">
        conflict_two_deposits
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/both_sign/conflicts/sc_ws_conflict_two_offchain_updates.html" class="md-nav__link">
        conflict_two_offchain_updates
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/both_sign/conflicts/sc_ws_conflict_two_withdrawals.html" class="md-nav__link">
        conflict_two_withdrawals
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/both_sign/conflicts/sc_ws_conflict_withdrawal_and_deposit.html" class="md-nav__link">
        conflict_withdrawal_and_deposit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/both_sign/conflicts/sc_ws_conflict_withdrawal_and_offchain_update.html" class="md-nav__link">
        conflict_withdrawal_and_offchain_update
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_2_2_4" type="checkbox" id="__nav_5_4_2_2_4" >
      
      <label class="md-nav__link" for="__nav_5_4_2_2_4">
        Changeable Fee
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Changeable Fee" data-md-level="5">
        <label class="md-nav__title" for="__nav_5_4_2_2_4">
          <span class="md-nav__icon md-icon"></span>
          Changeable Fee
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/changeable_fee/sc_ws_set_fee_close_mutual.html" class="md-nav__link">
        set_fee_close_mutual
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/changeable_fee/sc_ws_set_fee_close_solo.html" class="md-nav__link">
        set_fee_close_solo
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/changeable_fee/sc_ws_set_fee_create.html" class="md-nav__link">
        set_fee_create
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/changeable_fee/sc_ws_set_fee_deposit.html" class="md-nav__link">
        set_fee_deposit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/changeable_fee/sc_ws_set_fee_settle.html" class="md-nav__link">
        set_fee_settle
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/changeable_fee/sc_ws_set_fee_slash.html" class="md-nav__link">
        set_fee_slash
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/changeable_fee/sc_ws_set_fee_snapshot.html" class="md-nav__link">
        set_fee_snapshot
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/changeable_fee/sc_ws_set_fee_withdrawal.html" class="md-nav__link">
        set_fee_withdrawal
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_2_2_5" type="checkbox" id="__nav_5_4_2_2_5" >
      
      <label class="md-nav__link" for="__nav_5_4_2_2_5">
        Continuous
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Continuous" data-md-level="5">
        <label class="md-nav__title" for="__nav_5_4_2_2_5">
          <span class="md-nav__icon md-icon"></span>
          Continuous
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/continuous/init_per_group.html" class="md-nav__link">
        init_per_group
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/continuous/sc_ws_deposit.html" class="md-nav__link">
        deposit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/continuous/sc_ws_failed_update.html" class="md-nav__link">
        failed_update
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/continuous/sc_ws_generic_messages.html" class="md-nav__link">
        generic_messages
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/continuous/sc_ws_ping_pong.html" class="md-nav__link">
        ping_pong
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/continuous/sc_ws_update_conflict.html" class="md-nav__link">
        update_conflict
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/continuous/sc_ws_withdraw.html" class="md-nav__link">
        withdraw
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_2_2_6" type="checkbox" id="__nav_5_4_2_2_6" >
      
      <label class="md-nav__link" for="__nav_5_4_2_2_6">
        Contracts
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Contracts" data-md-level="5">
        <label class="md-nav__title" for="__nav_5_4_2_2_6">
          <span class="md-nav__icon md-icon"></span>
          Contracts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/contracts/init_per_group.html" class="md-nav__link">
        init_per_group
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/contracts/sc_ws_basic_contracts.html" class="md-nav__link">
        basic_contract
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/contracts/sc_ws_environment_contract.html" class="md-nav__link">
        environment_contract
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/contracts/sc_ws_nameservice_contract.html" class="md-nav__link">
        nameservice_contract
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/contracts/sc_ws_oracle_contract.html" class="md-nav__link">
        oracle_contract
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/contracts/sc_ws_remote_call_contract.html" class="md-nav__link">
        remote_call_contract
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/contracts/sc_ws_remote_call_contract_refering_onchain_data.html" class="md-nav__link">
        remote_call_contract_refering_onchain_data
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/contracts/sc_ws_wrong_call_data.html" class="md-nav__link">
        wrong_call_data
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_2_2_7" type="checkbox" id="__nav_5_4_2_2_7" >
      
      <label class="md-nav__link" for="__nav_5_4_2_2_7">
        Force Progress
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Force Progress" data-md-level="5">
        <label class="md-nav__title" for="__nav_5_4_2_2_7">
          <span class="md-nav__icon md-icon"></span>
          Force Progress
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/force_progress/sc_ws_force_progress_based_on_offchain_state.html" class="md-nav__link">
        force_progress_based_on_offchain_state
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/force_progress/sc_ws_force_progress_based_on_onchain_state.html" class="md-nav__link">
        force_progress_based_on_onchain_state
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_2_2_8" type="checkbox" id="__nav_5_4_2_2_8" >
      
      <label class="md-nav__link" for="__nav_5_4_2_2_8">
        Generalized Accounts
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Generalized Accounts" data-md-level="5">
        <label class="md-nav__title" for="__nav_5_4_2_2_8">
          <span class="md-nav__icon md-icon"></span>
          Generalized Accounts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_2_2_8_1" type="checkbox" id="__nav_5_4_2_2_8_1" >
      
      <label class="md-nav__link" for="__nav_5_4_2_2_8_1">
        both
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="both" data-md-level="6">
        <label class="md-nav__title" for="__nav_5_4_2_2_8_1">
          <span class="md-nav__icon md-icon"></span>
          both
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/generalized_accounts/both/sc_ws_basic_open_close.html" class="md-nav__link">
        basic_open_close
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_2_2_8_2" type="checkbox" id="__nav_5_4_2_2_8_2" >
      
      <label class="md-nav__link" for="__nav_5_4_2_2_8_2">
        initiator
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="initiator" data-md-level="6">
        <label class="md-nav__title" for="__nav_5_4_2_2_8_2">
          <span class="md-nav__icon md-icon"></span>
          initiator
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/generalized_accounts/initiator/sc_ws_basic_open_close.html" class="md-nav__link">
        basic_open_close
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_2_2_8_3" type="checkbox" id="__nav_5_4_2_2_8_3" >
      
      <label class="md-nav__link" for="__nav_5_4_2_2_8_3">
        responder
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="responder" data-md-level="6">
        <label class="md-nav__title" for="__nav_5_4_2_2_8_3">
          <span class="md-nav__icon md-icon"></span>
          responder
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/generalized_accounts/responder/sc_ws_basic_open_close.html" class="md-nav__link">
        basic_open_close
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_2_2_9" type="checkbox" id="__nav_5_4_2_2_9" >
      
      <label class="md-nav__link" for="__nav_5_4_2_2_9">
        Only One Signs
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Only One Signs" data-md-level="5">
        <label class="md-nav__title" for="__nav_5_4_2_2_9">
          <span class="md-nav__icon md-icon"></span>
          Only One Signs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/only_one_signs/init_per_group.html" class="md-nav__link">
        init_per_group
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/only_one_signs/sc_ws_conflict_on_new_offchain.html" class="md-nav__link">
        conflict_on_new_offchain
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/only_one_signs/sc_ws_conflict_snapshot_and_offchain_update.html" class="md-nav__link">
        sc_ws_conflict_snapshot_and_offchain_update
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_2_2_9_4" type="checkbox" id="__nav_5_4_2_2_9_4" >
      
      <label class="md-nav__link" for="__nav_5_4_2_2_9_4">
        conflicts
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="conflicts" data-md-level="6">
        <label class="md-nav__title" for="__nav_5_4_2_2_9_4">
          <span class="md-nav__icon md-icon"></span>
          conflicts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/only_one_signs/conflicts/sc_ws_conflict_deposit_and_offchain_update.html" class="md-nav__link">
        conflict_deposit_and_offchain_update
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/only_one_signs/conflicts/sc_ws_conflict_two_deposits.html" class="md-nav__link">
        conflict_two_deposits
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/only_one_signs/conflicts/sc_ws_conflict_two_offchain_updates.html" class="md-nav__link">
        conflict_two_offchain_updates
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/only_one_signs/conflicts/sc_ws_conflict_two_withdrawals.html" class="md-nav__link">
        conflict_two_withdrawals
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/only_one_signs/conflicts/sc_ws_conflict_withdrawal_and_deposit.html" class="md-nav__link">
        conflict_withdrawal_and_deposit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/only_one_signs/conflicts/sc_ws_conflict_withdrawal_and_offchain_update.html" class="md-nav__link">
        conflict_withdrawal_and_offchain_update
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_2_2_10" type="checkbox" id="__nav_5_4_2_2_10" >
      
      <label class="md-nav__link" for="__nav_5_4_2_2_10">
        Reconnect
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Reconnect" data-md-level="5">
        <label class="md-nav__title" for="__nav_5_4_2_2_10">
          <span class="md-nav__icon md-icon"></span>
          Reconnect
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/reconnect/sc_ws_basic_client_reconnect_i.html" class="md-nav__link">
        basic_client_reconnect_i
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/reconnect/sc_ws_basic_client_reconnect_i_w_reestablish.html" class="md-nav__link">
        basic_client_reconnect_i_w_reestablish
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/reconnect/sc_ws_basic_client_reconnect_r.html" class="md-nav__link">
        basic_client_reconnect_r
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4_2_2_11" type="checkbox" id="__nav_5_4_2_2_11" >
      
      <label class="md-nav__link" for="__nav_5_4_2_2_11">
        With Meta
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="With Meta" data-md-level="5">
        <label class="md-nav__title" for="__nav_5_4_2_2_11">
          <span class="md-nav__icon md-icon"></span>
          With Meta
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/with_meta/init_per_group.html" class="md-nav__link">
        init_per_group
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/with_meta/sc_ws_deposit.html" class="md-nav__link">
        deposit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/with_meta/sc_ws_remote_call_contract.html" class="md-nav__link">
        remote_call_contract
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/with_meta/sc_ws_withdraw.html" class="md-nav__link">
        withdraw
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/sc_ws_basic_open_close_server.html" class="md-nav__link">
        basic_open_close
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/sc_ws_basic_open_close.html" class="md-nav__link">
        basic_open_close_server
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/sc_ws_broken_open_params.html" class="md-nav__link">
        broken_open_params
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/sc_ws_close_mutual.html" class="md-nav__link">
        close_mutual
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/sc_ws_close_solo.html" class="md-nav__link">
        close_solo
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/sc_ws_leave_reconnect.html" class="md-nav__link">
        leave_reconnect
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/sc_ws_leave_reestablish.html" class="md-nav__link">
        leave_reestablish
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/sc_ws_leave_reestablish_responder_stays.html" class="md-nav__link">
        leave_reestablish_responder_stays
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/sc_ws_leave_reestablish_wrong_fsm_id.html" class="md-nav__link">
        leave_reestablish_wrong_fsm_id
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/sc_ws_min_depth_is_modifiable.html" class="md-nav__link">
        min_depth_is_modifiable
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/sc_ws_min_depth_not_reached_timeout.html" class="md-nav__link">
        min_depth_not_reached_timeout
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/sc_ws_opening_ping_pong.html" class="md-nav__link">
        opening_ping_pong
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/sc_ws_reconnect_early.html" class="md-nav__link">
        reconnect_early
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/sc_ws_slash.html" class="md-nav__link">
        slash
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/sc_ws_snapshot_solo.html" class="md-nav__link">
        snapshot_solo
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/sc_ws_timeout_open.html" class="md-nav__link">
        timeout_open
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../node/api/examples/channels/json-rpc/sc_ws_update_with_meta.html" class="md-nav__link">
        update_with_meta
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Mining
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Mining" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Mining
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../STRATUM.html" class="md-nav__link">
        Stratum
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../serializations.html" class="md-nav__link">
        Serializations
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#establishing-a-channel" class="md-nav__link">
    Establishing a channel
  </a>
  
    <nav class="md-nav" aria-label="Establishing a channel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#channel_create" class="md-nav__link">
    channel_create
  </a>
  
    <nav class="md-nav" aria-label="channel_create">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generalized-accounts" class="md-nav__link">
    Generalized accounts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-a-channel" class="md-nav__link">
    Updating a channel
  </a>
  
    <nav class="md-nav" aria-label="Updating a channel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#channel_deposit" class="md-nav__link">
    channel_deposit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel_withdraw" class="md-nav__link">
    channel_withdraw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel_snapshot_solo" class="md-nav__link">
    channel_snapshot_solo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel_set_delegates" class="md-nav__link">
    channel_set_delegates
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#closing-a-channel" class="md-nav__link">
    Closing a channel
  </a>
  
    <nav class="md-nav" aria-label="Closing a channel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#channel_close_mutual" class="md-nav__link">
    channel_close_mutual
  </a>
  
    <nav class="md-nav" aria-label="channel_close_mutual">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements_1" class="md-nav__link">
    Requirements
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel_close_solo" class="md-nav__link">
    channel_close_solo
  </a>
  
    <nav class="md-nav" aria-label="channel_close_solo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#empty-payload" class="md-nav__link">
    Empty payload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#off-chain-transaction-payload" class="md-nav__link">
    Off-chain transaction payload
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel_settle" class="md-nav__link">
    channel_settle
  </a>
  
    <nav class="md-nav" aria-label="channel_settle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements_2" class="md-nav__link">
    Requirements
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#forcing-progress" class="md-nav__link">
    Forcing progress
  </a>
  
    <nav class="md-nav" aria-label="Forcing progress">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#channel_force_progress_tx" class="md-nav__link">
    channel_force_progress_tx
  </a>
  
    <nav class="md-nav" aria-label="channel_force_progress_tx">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#empty-payload_1" class="md-nav__link">
    Empty Payload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#off-chain-transaction-payload_1" class="md-nav__link">
    Off-chain transaction Payload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#force-progress-side-effects" class="md-nav__link">
    Force progress side effects
  </a>
  
    <nav class="md-nav" aria-label="Force progress side effects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-channel-object" class="md-nav__link">
    Updating channel object
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call-object" class="md-nav__link">
    Call object
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#disputing-updates" class="md-nav__link">
    Disputing updates
  </a>
  
    <nav class="md-nav" aria-label="Disputing updates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#force-progress-dispute-with-closing-channel" class="md-nav__link">
    Force progress dispute with closing channel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#force-progress-dispute-with-open-channel-example" class="md-nav__link">
    Force progress dispute with open channel example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#force-progress-dispute-with-closing-channel-example" class="md-nav__link">
    Force progress dispute with closing channel example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel-slash" class="md-nav__link">
    Channel slash
  </a>
  
    <nav class="md-nav" aria-label="Channel slash">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#off-chain-transaction-payload_2" class="md-nav__link">
    Off-chain transaction payload
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requirements_3" class="md-nav__link">
    Requirements
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel-state-tree" class="md-nav__link">
    Channel state tree
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/aeternity/protocol/edit/master/docs/channels/ON-CHAIN.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="on-chain">On-chain</h1>
<p>Operating a state channel requires, an initial on-chain setup via a
<code>channel_create_tx</code> transaction, that locks up a configurable amount of coins from
each involved party in the channel. This requires a consent, in the form of
either signatures or generalized account authentication call data, from both
participants. More information regarding authentication can be found
<a href="authentication.html">here</a></p>
<p>In the ideal case, all on-chain transactions get authenticated by both
participants, implying that there are no disagreements. These operations can
be committed immediately. There are also some unilateral transactions that
need to be authenticated just by one of the participants. Those might have a
block height timer attached to them for the other party to dispute. The mutually
agreed ones will override all conflicting unilateral actions.</p>
<p>Transactions not authenticated by everyone can be disputed via
<code>channel_slash_tx</code>, <code>channel_snapshot_solo_tx</code> and <code>channel_force_progress_tx</code>
transactions. During normal operation, these solo transactions can be disputed
indefinitely. If the channel is in the closing state, disputes have to happen
within the pre-negotiated <code>lock_period</code>, given that closure requires a bounded
finality.</p>
<p>Each channel transaction updating on-chain state provides two fields essential
for future conflict resolution: <code>round</code> and <code>state_hash</code>. The state hash is
the root hash of the channel's state tree after the on-chain has been applied
to the local state tree. The <code>round</code> is the state channel's internal round.
Since the <code>round</code> is incrementing on every off-chain state change, the channel
transaction both represents the off-chain state of the channel and defines the
point of time when it was valid. This allows us to make educated decisions on
whether or not to update the on-chain persisted channel object. This way we
can solo close a channel according to the last provided on-chain state. All we
have to do is to provide a proof of inclusion having the same <code>state_hash</code>.</p>
<ul>
<li><a href="#establishing-a-channel">Establishing a channel</a><ul>
<li><a href="#channel_create"><code>channel_create</code></a></li>
</ul>
</li>
<li><a href="#updating-a-channel">Updating a channel</a><ul>
<li><a href="#channel_deposit"><code>channel_deposit</code></a></li>
<li><a href="#channel_withdraw"><code>channel_withdraw</code></a></li>
<li><a href="#channel_snapshot_solo"><code>channel_snapshot_solo</code></a></li>
<li><a href="#channel_set_delegates"><code>channel_set_delegates</code></a></li>
</ul>
</li>
<li><a href="#closing-a-channel">Closing a channel</a><ul>
<li><a href="#channel_close_mutual"><code>channel_close_mutual</code></a></li>
<li><a href="#channel_close_solo"><code>channel_close_solo</code></a></li>
<li><a href="#channel_settle"><code>channel_settle</code></a></li>
</ul>
</li>
<li><a href="#disputing-updates">Disputing updates</a><ul>
<li><a href="#channel_slash"><code>channel_slash</code></a></li>
</ul>
</li>
<li><a href="#forcing-progress">Forcing progress</a><ul>
<li><a href="#channel_force_progress_tx"><code>channel_force_progress_tx</code></a></li>
</ul>
</li>
<li><a href="#channel-state-tree">Channel state tree</a></li>
</ul>
<h2 id="establishing-a-channel">Establishing a channel</h2>
<p>All of the on-chain operations could be submitted by any peer but we assume that
the initiating peer pays for the setup of the channel. Therefore the <code>initiator</code>
MUST pay the <code>channel_create_tx</code> transaction fees.</p>
<h3 id="channel_create"><code>channel_create</code></h3>
<p>The <code>channel_create_tx</code> transaction is used to register a channel on-chain and its
inclusion on-chain causes the specified amounts to be locked up as a guarantee
that participants have a vested interest in the channel. Although it is not a
strict requirement, it is strongly suggested to do so.</p>
<p>e.g.</p>
<div class="highlight"><pre><span></span><code>Account(initiator).balance := Account(initiator).balance - initiator_amount

Account(responder).balance := Account(responder).balance - responder_amount

Channel(cid).amount := initiator_amount + responder_amount
</code></pre></div>
<p>Serialization defined <a href="../serializations.html#channel-create-transaction">here</a></p>
<ul>
<li><code>initiator_id</code>: account id of the initiating peer</li>
<li><code>responder_id</code>: account id of the responding peer</li>
<li><code>initiator_amount</code>: unsigned amount of coins the initiator commits to the
  channel</li>
<li><code>responder_amount</code>: unsigned amount of coins the responder commits to the
  channel</li>
<li><code>lock_period</code>: period for disputes after solo operations</li>
<li><code>delegate_ids</code>, <code>initiator_delegate_ids</code> and <code>responder_delegate_ids</code>: lists
  of delegate account ids. The delegates play a role in the solo closing
  sequence: except for the participants of the channel, they are the only ones
  that can provide a snapshot, slash or forced progress transactions. Pre
  <code>iris</code> there is only a single list of delegates and from <code>iris</code> on those are
  fine grained on a participant level</li>
<li><code>state_hash</code>: the root hash of the channel state tree; This is not validated,
  just kept in the channel's object as initial value. This come into play if
  participants enter a dispute right after opening the channel on-chain.</li>
<li><code>ttl</code>: blockheight target until which this transaction can be included</li>
<li><code>fee</code>: transaction fee</li>
<li><code>nonce</code>: <code>initiator</code>'s account nonce or 0 if one is a generalized account</li>
</ul>
<p>The length of the <code>lock_period</code> is a trade-off between responsiveness, e.g. how
fast solo operations can be committed, and security. Choosing a <code>lock_period</code>
that gives participants enough time to react to potential malicious solo
operations is crucial.</p>
<p>The <code>ttl</code> is in absolute chain height. The involved parties will want to set the
<code>ttl</code> to a value quite a bit larger than the present chain height, to avoid
uncertainty. If the fees included are low and transaction pressure is high, then
the transaction might end up being stuck in the mempool for an extended period.
<code>ttl</code> is optional, no <code>ttl</code> means a transaction that is valid "forever".</p>
<p>The <code>fee</code> and <code>nonce</code> refer to the <code>initiator</code> account, i.e. the <code>fee</code> MUST be
taken from their balance and the <code>nonce</code> of their account MUST be incremented.</p>
<h4 id="generalized-accounts">Generalized accounts</h4>
<p>If either of the participants is a <a href="../generalized_accounts/index.html">Generalized
account</a> the channel create
will also create an extra entry in the contract state tree, containing a frozen
authentication state that will be used for off-chain authentication and
verification in off-chain updates (potentially eventually enforced on-chain)
of this particular channel.  A more detailed explaination can be found
<a href="authentication.html">here</a></p>
<h4 id="requirements">Requirements</h4>
<p><code>Account(initiator).balance &gt;= initiator_amount + fee</code></p>
<p><code>Account(responder).balance &gt;= responder_amount</code></p>
<p><code>initiator_amount &gt;= channel_reserve</code></p>
<p><code>responder_amount &gt;= channel_reserve</code></p>
<h2 id="updating-a-channel">Updating a channel</h2>
<p>An update to an open channel requires the authentication of all participants
and a channel identification (<code>channel_id</code>).</p>
<p>Both <code>channel_deposit_tx</code> and <code>channel_withdraw_tx</code> MUST be authenticated by
all involved parties, since changing channel balances might change the
dynamics of code running in a channel.</p>
<p>The <code>channel_id</code> is computed from the public key of the initiator, the nonce of
the create transaction and the public key of the responder using Blake2b (256
bits digest).</p>
<div class="highlight"><pre><span></span><code>channel_id = Blake2b(initiator || channel_create_tx_nonce || responder)
                        32                  32                  32
</code></pre></div>
<h3 id="channel_deposit"><code>channel_deposit</code></h3>
<p>Depositing funds into a channel after its creation provides the means for a
participant to move coins from the participant's balance to the channel's one.
This should allow channels to be more long-lived due to the increased ease of
balancing them out. The amount of coins sent along with this transaction will
get locked up just like the initial deposit.</p>
<p>While it could be desirable to allow anyone to deposit into a channel, we are
going to restrict deposits to the peers of a channel. That means, the <code>from_id</code>
field MUST be an address of one of the participants of the targeted channel and
the standard transaction fee MUST be paid by the <code>from_id</code> account.</p>
<p>This operation is not mandatory for normal channel operation.</p>
<p>Serialization defined <a href="../serializations.html#channel-deposit-transaction">here</a></p>
<ul>
<li><code>channel_id</code>: channel id as recorded on-chain</li>
<li><code>from_id</code>: sender of the deposit</li>
<li><code>amount</code>: amount of coins deposited</li>
<li><code>state_hash</code>: the root hash of the channel state tree after the deposit has
  been applied to it; This is not validated on-chain, just kept in the
  channel's object</li>
<li><code>round</code>: the channel's internal round that applies the deposit</li>
<li><code>ttl</code>: blockheight target until which this transaction can be included</li>
<li><code>fee</code>: transaction fee</li>
<li><code>nonce</code>: <code>from_id</code>'s account nonce</li>
</ul>
<p>Note that the <code>round</code> SHOULD be incremented on each off-chain update. This
means, in order for an on-chain transaction, referring to off-chain state, to
be considered valid, it MUST include a <code>round</code> higher than the currently
recorded <code>Channel(channel_id).round</code>.</p>
<p>If this transaction is valid then it sets:</p>
<ul>
<li><code>Channel(channel_id).round := round</code></li>
<li><code>Channel(channel_id).solo_round := 0</code></li>
<li><code>Channel(channel_id).state_hash := state_hash</code></li>
<li><code>Channel(channel_id).total_amount := Channel(channel_id).total_amount + amount</code></li>
</ul>
<h3 id="channel_withdraw"><code>channel_withdraw</code></h3>
<p>Channels should generally not be used to hold significant amounts of coins but
being able to withdraw locked coins might still be of use.</p>
<p>Serialization defined <a href="../serializations.html#channel-withdraw-transaction">here</a></p>
<ul>
<li><code>channel_id</code>: channel id as recorded on-chain</li>
<li><code>to</code>: receiver of the withdraw</li>
<li><code>amount</code>: amount of coins withdrawn</li>
<li><code>state_hash</code>: the root hash of the channel state tree after the withdraw had
  been applied; This is not validated, just kept in the channel's object</li>
<li><code>round</code>: the channel's internal round that applies the withdraw</li>
<li><code>ttl</code>: blockheight target until which this transaction can be included</li>
<li><code>fee</code>: transaction fee</li>
<li><code>nonce</code>: <code>to</code>'s account nonce</li>
</ul>
<p>The <code>to</code> account MUST be a participant in the target channel. The <code>amount</code>
MUST be less than or equal to the sum of the channel balance with regard to the
<code>channel_reserve</code> ammounts, i.e. channels cannot create coins out of thin air
but also a minimum of <code>channel_reserve</code> must remain locked in the channel. The
fee is paid by the <code>to</code> account and that account should hold enough coins to
pay the fee, i.e., the fee is subtracted before the withdrawn coins arrive.</p>
<p>Note that the <code>round</code> SHOULD be incremented on each off-chain update. This
means, in order for an on-chain transaction, referring to off-chain state, to
be considered valid, it MUST include a <code>round</code> higher than or equal to the
currently recorded <code>Channel(channel_id).round</code>.</p>
<p>If this transaction is valid then it sets:</p>
<ul>
<li><code>Channel(channel_id).round := round</code></li>
<li><code>Channel(channel_id).solo_round := 0</code></li>
<li><code>Channel(channel_id).state_hash := state_hash</code></li>
<li><code>Channel(channel_id).total_amount := Channel(channel_id).total_amount - amount</code></li>
</ul>
<h3 id="channel_snapshot_solo"><code>channel_snapshot_solo</code></h3>
<p>In order to make channels both secure and trustless even when one party goes
offline, we provide the functionality of snapshots.
Snapshots provide a recent off-chain state to be recorded on-chain. This state
is represented by a <code>round</code> and a <code>state_hash</code>. Those are proven to be correct
at least at some point of time in the past by providing a co-authenticated
off-chain update as a <code>payload</code>. Note that the <code>payload</code> can not be an
on-chain transaction.
After <code>channel_snapshot_solo_tx</code> inclusion the channel can not be closed using an
older state—as indicated by the <code>round</code>—than the one provided in the snapshot.</p>
<p>Serialization defined <a href="../serializations.html#channel-snapshot-solo-transaction">here</a></p>
<ul>
<li><code>channel_id</code>: channel id as recorded on-chain</li>
<li><code>from_id</code>: the account that posts the transaction</li>
<li><code>payload</code>: an off-chain transaction of the same channel authenticated
  by both parties</li>
<li><code>ttl</code>: blockheight target until which this transaction can be included</li>
<li><code>fee</code>: transaction fee</li>
<li><code>nonce</code>: the <code>from_id</code> account nonce</li>
</ul>
<p>The <code>from_id</code> account MUST be a participant or a delegate in the target
channel. The <code>payload</code> MUST be an off-chain state. It MUST provide correct
authentication methods for both parties. It MUST be part of the same channel
(containing same channel id) and it MUST have a <code>round</code> higher than the one
currently recorded on-chain.</p>
<p>This transaction MUST NOT trigger the <code>lock_period</code> and MUST NOT be used when
the channel is in the closing state. It can be used to overwrite a state produced
by a <code>channel_force_progress_tx</code> while the channel is in the open state.</p>
<p>If this transaction is valid then it sets:</p>
<ul>
<li><code>Channel(channel_id).round := payload.round</code></li>
<li><code>Channel(channel_id).solo_round := 0</code></li>
<li><code>Channel(channel_id).state_hash := payload.state_hash</code></li>
</ul>
<h3 id="channel_set_delegates"><code>channel_set_delegates</code></h3>
<p>In order to make channels both secure and trustless even when one party goes
offline, a participant can deleate the right to produce certain transactions
to other third parties.
Delegates are set initially in the <code>channel_create_tx</code> and, since the <code>iris</code>
hardfork, can be updated with <code>channel_set_delegates_tx</code>. It acts similarly to
<code>channel_snapshot_solo_tx</code> with three notable differences:</p>
<ul>
<li>
<p>While <code>channel_snapshot_solo_tx</code> can be based only on off-chain state,
  <code>channel_set_delegates_tx</code> can be based both on off-chain state or latest
  on-chain state. In the latter case the <code>payload</code> provided is empty.</p>
</li>
<li>
<p><code>channel_set_delegates_tx</code> is mutually agreed upon. If the other participant
  does not want to approve such a transaction, this could be a clear sign that
  the assumption of cooperation is broken.</p>
</li>
<li>
<p><code>channel_set_delegates_tx</code> not only updates the on-chain channel object
  but also sets the list of delegate ids for each participant. The old lists of
  delegates are deleted and the new ones provided by the transaction replace
  them. There is no option for setting the list just for one participant.</p>
</li>
</ul>
<p>Serialization defined <a href="../serializations.html#channel-set-delegates-transaction">here</a></p>
<ul>
<li><code>channel_id</code>: channel id as recorded on-chain</li>
<li><code>from_id</code>: the account that posts the transaction</li>
<li><code>initiator_delegate_ids</code>: the list of delegates that can provide
  transactions on behalf of the <code>initiator</code></li>
<li><code>responder_delegate_ids</code>: the list of delegates that can provide
  transactions on behalf of the <code>responder</code></li>
<li><code>payload</code>: an off-chain transaction of the same channel authenticated
  by both parties. It could be empty</li>
<li><code>state_hash</code>: the hash of the payload, if provided - and if not, the latest
  provided on-chain <code>state_hash</code></li>
<li><code>round</code>: the hash of the payload, if provided - and if not, the latest
  provided on-chain <code>round</code></li>
<li><code>ttl</code>: blockheight target until which this transaction can be included</li>
<li><code>fee</code>: transaction fee</li>
<li><code>nonce</code>: the <code>from_id</code> account nonce</li>
</ul>
<p>The <code>from_id</code> account MUST be a participant in the target
channel. The <code>payload</code> MUST be an off-chain state or empty. It MUST provide correct
authentication methods for both parties. It MUST be part of the same channel
(containing same channel id). If provided, it MUST have a <code>round</code> higher than
the one currently recorded on-chain. The <code>state_hash</code> and <code>round</code> must match
the ones in <code>payload</code> or the on-chain stored data if the <code>payload</code> is empty.</p>
<p>This transaction MUST NOT trigger the <code>lock_period</code> and MUST NOT be used when
the channel is in the closing state. It can be used to overwrite a state produced
by a <code>channel_force_progress_tx</code> while the channel is in the open state.</p>
<p>If this transaction is valid then it sets:</p>
<ul>
<li><code>Channel(channel_id).round := round</code></li>
<li><code>Channel(channel_id).solo_round := 0</code></li>
<li><code>Channel(channel_id).state_hash := state_hash</code></li>
<li><code>Channel(channel_id).initiator_delegate_ids := initiator_delegate_ids</code></li>
<li><code>Channel(channel_id).responder_delegate_ids := responder_delegate_ids</code></li>
</ul>
<h2 id="closing-a-channel">Closing a channel</h2>
<p>We expect channels to be long running but they could be closed. This shall
happen when participants have completed their interaction but this includes also the
cases of non-cooperation or malicious behaviour. If both parties decide to
close the channel, closing is just a matter of issuing one on-chain
transaction, authenticated by everyone involved.</p>
<p>In the case of a solo closing, operations are subject to the <code>lock_period</code>,
during which the closing state can be disputed via a <code>channel_slash_tx</code> or
even progressed further on-chain via <code>channel_force_progress_tx</code> transactions.</p>
<h3 id="channel_close_mutual"><code>channel_close_mutual</code></h3>
<p>Serialization defined
<a href="../serializations.html#channel-close-mutual-transaction">here</a></p>
<ul>
<li><code>channel_id</code>: channel id as recorded on-chain</li>
<li><code>from_id</code>: the account that posts the transaction</li>
<li><code>initiator_amount_final</code>: final balance for the initiator</li>
<li><code>responder_amount_final</code>: final balance for the responder</li>
<li><code>ttl</code>: blockheight target until which this transaction can be included</li>
<li><code>fee</code>: transaction fee</li>
<li><code>nonce</code>: the <code>from_id</code> account nonce</li>
</ul>
<p><code>initiator_amount_final</code> and <code>responder_amount_final</code> are the agreed upon
distribution of coins out of the channel total balance of coins.  The
initiator's and responder's account balances are incremented by
<code>initiator_amount_final</code> and <code>responder_amount_final</code> respectively.  The
channel MUST have enough total coins to pay for the fee as well as the agreed
upon amounts. The total closing amount of a channel is computed by adding the
amounts of the initiator and responder (before the close) and the fee. If this
total closing amount is lower than the total amount coins already dedicated to
the channel, the excess of coins is <a href="../consensus/locking.html">locked</a>.</p>
<h4 id="requirements_1">Requirements</h4>
<p>This transaction MUST have valid authentications of both parties.</p>
<p>This transaction MUST NOT be disputed and any ongoing dispute MUST be considered
resolved by this transaction.</p>
<p>After this transaction has been included in a block, the channel MUST be
considered closed and allow no further modifications. The on-chain persisted
channel object is removed from the on-chain state trees.</p>
<p><code>channel total &gt;=
  transcation initiator_amount_final + responder_amount_final + fee</code></p>
<h3 id="channel_close_solo"><code>channel_close_solo</code></h3>
<p>In order to close a channel unilaterally, a participant has to send a
<code>channel_close_solo</code> transaction. This is only necessary if one peer stops
responding or cooperating but can also be used by an malicious peer trying to
close a channel with a state that hasn't been agreed on by all participants.</p>
<p>At any point a channel participant can initiate the solo closing sequence.
After the <code>channel_close_solo</code> is posted and included in the chain a
<code>lock_period</code> block height timer is started.
This lock period is required to give the other party an opportunity to dispute
the final state, that the closing sequence is based on. This can be done via
the <code>channel_slash_tx</code> and <code>channel_force_progress_tx</code> transactions.</p>
<p>With the inclusion of this transaction on-chain, the channel enters the <code>locked</code>
state, during which the <code>channel_close_solo_tx</code> can be disputed.</p>
<p>Serialization defined <a href="../serializations.html#channel-close-solo-transaction">here</a></p>
<ul>
<li><code>channel_id</code>: channel id as recorded on-chain</li>
<li><code>from_id</code>: participant of the channel that posts the closing transaction</li>
<li><code>payload</code>: empty or an authenticated off-chain state proving that the proof
  of inclusion is part of the channel</li>
<li><code>poi</code>: proof of inclusion</li>
<li><code>ttl</code>: blockheight target until which this transaction can be included</li>
<li><code>fee</code>: transaction fee</li>
<li><code>nonce</code>: according to the <code>from_id</code>'s account</li>
</ul>
<p>Proof of inclusion represents the channel's internal state. At the bare minimum
it has to include all accounts and their balances. It MUST provide enough
information to close the channel. Miners are to check balances in it and use
this data to update the channel's on-chain representation. This is how the
poster initiates the solo closing sequence.
If there are any contracts in the channel and those have balances of their own,
they are not provided in the proof of inclusion but they are rather could be
force-pushed in subsequent transactions. It is up to participants to decide
if they want to post them at all. Thus the accumulative balances of the
accounts in the solo-close transaction can be lower than the channel balance
persisted on-chain.</p>
<p>The <code>payload</code> can be either empty or an authentication off-chain state
transaction.</p>
<h4 id="empty-payload">Empty payload</h4>
<p>If the payload is empty, the last on-chain persisted <code>state_hash</code> and
<code>solo_round</code> are used. In this case the proof of inclusion root hash MUST be
equal to the one persisted for the channel on-chain. If that state was
produced unilaterally, i.e. via a <code>channel_force_progress_tx</code>, making
<code>Channel(channel_id).round != Channel(channel_id).solo_round</code>, the solo close
is based on the <code>solo_round</code> and thus can still be disputed.</p>
<ul>
<li><code>Channel(channel_id).locked_until := Block.height + Channel(channel_id).lock_period</code></li>
</ul>
<h4 id="off-chain-transaction-payload">Off-chain transaction payload</h4>
<p>If the payload is a transaction it MUST be a <code>channel_offchain_tx</code>. It MUST be
authenticated by both participants.</p>
<p>Payload is a valid transaction that has:</p>
<ul>
<li><code>state_hash</code> equal to the proof of inclusion's root hash. This is a proof
  that the PoI is correct</li>
<li><code>channel_id</code> being the same as the transaction <code>channel_id</code></li>
<li><code>round</code> greater than <code>Channel(channel_id).round</code>. If
  <code>Channel(channel_id).solo_round &gt; Channel(channel_id).round</code>, then
  this close will invalidate progress produced on-chain</li>
</ul>
<p>If true, the following changes will be made:</p>
<ul>
<li><code>Channel(channel_id).round := payload.round</code></li>
<li><code>Channel(channel_id).solo_round := payload.round</code></li>
<li><code>Channel(channel_id).state_hash := payload.state_hash</code></li>
<li><code>Channel(channel_id).locked_until := Block.height + Channel(channel_id).lock_period</code></li>
</ul>
<h3 id="channel_settle"><code>channel_settle</code></h3>
<p>The settlement transaction is the last one in the lifecycle of a channel, but
only required if the parties involved did not manage to cooperate when trying
to close the channel. It has to be issued after all possible disputes are
resolved to then redistribute the locked coins.</p>
<p>The <code>channel_settle_tx</code> CAN only be included in a block if:</p>
<ul>
<li>a <code>channel_close_solo_tx</code> transaction was published and the <code>lock_period</code> has
  expired, i.e.  <code>blockheight(top) - blockheight(channel_close_solo_tx) &gt;=
  lock_period</code></li>
<li>there are no open disputes, which means that the channel is not currently
  locked from a prior solo action</li>
</ul>
<p>Serialization defined <a href="../serializations.html#channel-settle-transaction">here</a></p>
<ul>
<li><code>channel_id</code>: channel id as recorded on-chain</li>
<li><code>from_id</code>: participant of the channel that posts the settling transaction</li>
<li><code>initiator_amount_final</code>: unsigned amount of coins the initiator gets from the
  channel</li>
<li><code>responder_amount_final</code>: unsigned amount of coins the responder gets from the
  channel</li>
<li><code>ttl</code>: blockheight target until which this transaction can be included</li>
<li><code>fee</code>: transaction fee</li>
<li><code>nonce</code>: according to the <code>from_id</code>'s account</li>
</ul>
<h4 id="requirements_2">Requirements</h4>
<p>After this transaction has been included in a block, the channel MUST be
considered closed and allow no further modifications. After the transaction is
included, the channel object is removed from on-chain trees.</p>
<p>The transaction MUST be authenticated using the method corresponding to the
account behind <code>from_id</code>.</p>
<p>The amounts must correspond to the ones on-chain, provided by the last
<code>channel_close_solo_tx</code>, <code>channel_slash_tx</code> or a <code>channel_force_progress_tx</code>. The sum
of those final amounts form the total closing amount of the channel. If this
total closing amount is lower than the total amount of coins already dedicated to
the channel, the excess of coins is <a href="../consensus/locking.html">locked</a>.</p>
<h2 id="forcing-progress">Forcing progress</h2>
<p>Forcing progress is the mechanism to be used when a dispute arises between
parties and one of them wants to use the blockchain as an arbiter in a smart
contract. The poster provides the off-chain state so that an off-chain
contract can be executed on-chain and thus producing the channel's next
off-chain state.</p>
<p>This can happen both while a channel is closing or while it is still active. If
the channel is not closing, participants can continue using it from the on-chain
produced channel state or initiate a closing based on it. If the channel is
already closing, the force-progress updates what are the currently expected
closing amounts for each participant (according to the contract's execution).</p>
<p>The force progress is based on what is considered to be the latest off-chain
channel state. We have no way of proving that this state is actually the last
one so any progress on chain can always be invalidated by providing an
off-chain channel state, authenticated by both participants, with a higher round
number than the round number that the to-be-disputed
<code>channel_force_progress_tx</code> transaction used.</p>
<p>If the channel is in the closing state, issuing a <code>channel_force_progress_tx</code>
locks it for <code>lock_period</code> blocks, during which the update can be disputed. This
lock is necessary to prevent the channel from being closed immediately after
a new round has been produced on chain.</p>
<p>The forcer can be either a participant or, after <code>iris</code>, a delegate. The
latter can only force from behalf of the participant that had specified her to
do so, ex: <code>initiator</code>'s delegates can only force progress calls made from the
<code>initiator</code>'s account. Delegated forced progress is allowed only when the
channel is already in a closing state.</p>
<p>It is worth mentioning that what is to be disputed is the off-chain state that
the force progress had been based on and not the forcing of progress itself. If
an older state had been provided by the forcing party, the other party can post
a newer authenticated off-chain state (via a snapshot for example). The
authenticated by both participants off-chain state with the same or greater
round will replace the on-chain produced one.</p>
<h3 id="channel_force_progress_tx"><code>channel_force_progress_tx</code></h3>
<p>Serialization defined <a href="../serializations.html#channel-solo-force-progress-transaction">here</a></p>
<ul>
<li><code>channel_id</code>: channel id as recorded on-chain</li>
<li><code>from_id</code>: a participant or a delegate of the channel that posts the force
  progress transaction</li>
<li><code>payload</code>: empty or an off-chain state transaction proving that the state trees
  represent a mutually agreed-upon channel state</li>
<li><code>round</code>: channel's next round</li>
<li><code>update</code>: channel off-chain update that contains the contract call with gas
  limit and gas prices to be consumed for the on-chain execution of the
  off-chain contract. If it is a delegate that provides the force progress,
  the the <code>caller</code> of the off-chain contract MUST be a participant that had
  authorized this delegate</li>
<li><code>state_hash</code>: channel's expected new root hash of off-chain state trees</li>
<li><code>offchain_trees</code>: the full state channel's state trees</li>
<li><code>ttl</code>: blockheight target until which this transaction can be included</li>
<li><code>fee</code>: transaction fee</li>
<li><code>nonce</code>: according to the <code>from_id</code>'s account</li>
</ul>
<p>The <code>offchain_trees</code> is the full off-chain state trees set: all accounts and
all contracts. It MUST include both participants' off-chain accounts. It MUST
include the contract to be called.  Based on the <code>offchain_trees</code>, the next
state is going to be computed and its root hash will become the new state's
<code>state_hash</code>. The newly produced state trees will be different than the
provided ones at least with the newly added <code>call</code> object. Thus even if the
contract call fails a new <code>state_hash</code> is produced.</p>
<p>If this transaction is sent while the channel is in the <code>closing</code> state, it will
transition the channel into the <code>locked</code> state for the next <code>lock_period</code> blocks.
Although while this lasts, the channel can not be settled, new force-
progressed transactions can still be accepted before the timer expires. Those
MUST be based on the previous on-chain produced states but each next one
resets the dispute timer.</p>
<p>The payload can be either empty or an authenticated off-chain state transaction.</p>
<h4 id="empty-payload_1">Empty Payload</h4>
<p>If the payload is empty, the last on-chain persisted state and <code>solo_round</code> are
used. In this case the state trees root hash MUST be equal to the one persisted
for the channel on-chain.</p>
<p>If the contract execution is successful, the channel will be updated with:</p>
<ul>
<li><code>Channel(channel_id).solo_round := Channel(channel_id).solo_round + 1</code></li>
<li><code>Channel(channel_id).state_hash := state_hash</code></li>
</ul>
<p>Additionally, if the channel is in the <code>closing</code> state:</p>
<ul>
<li><code>Channel(channel_id).locked_until := Block.height + Channel(channel_id).lock_period</code></li>
</ul>
<h4 id="off-chain-transaction-payload_1">Off-chain transaction Payload</h4>
<p>If the payload is a transaction it MUST be a <code>channel_offchain_tx</code>. It MUST be
authenticated by both participants.</p>
<p>An off-chain transaction payload is a valid transaction if it has:</p>
<ul>
<li><code>state_hash</code> equal to the state trees' root hash. This is a proof that the
  <code>offchain_trees</code> represent a state both participants had agreed upon at some
  point of time</li>
<li><code>channel_id</code> being the same as the transaction <code>channel_id</code></li>
<li><code>round</code> greater than <code>Channel(channel_id).round</code></li>
</ul>
<p>The update MUST be a call to a contract. The caller of this update MUST be the
poster of the force progress transaction. <code>amount</code>, <code>gas</code> and <code>gas_price</code> are
specified in the update as well. The gas fees are going to be paid by the poster
of the transaction. The <code>gas_price</code> MUST match protocol expectations for
minimum gas price.
The <code>state_hash</code> will be the root hash of the updated channel's state trees.
After applying the contract call to the provided <code>offchain_trees</code> and updating
accounts accordingly, a new channel's state tree is produced. It MUST have the
same value of root hash as the state hash. If those do not match the force
progress fails but since this can only be determined after the call has been
executed, a call object is added on-chain and gas is consumed.</p>
<p>If the contract call succeeded, the channel state will be updated:</p>
<ul>
<li><code>Channel(channel_id).round := payload.round</code></li>
<li><code>Channel(channel_id).solo_round := payload.round + 1</code></li>
<li><code>Channel(channel_id).state_hash := state_hash</code></li>
</ul>
<p>Additionally, if the channel is in the <code>closing</code> state:</p>
<ul>
<li><code>Channel(channel_id).locked_until := Block.height + Channel(channel_id).lock_period</code></li>
</ul>
<h4 id="force-progress-side-effects">Force progress side effects</h4>
<h5 id="updating-channel-object">Updating channel object</h5>
<p>Channel state trees are recreated according to the <code>offchain_trees</code> being
provided. The update is an off-chain contract call. It is applied on the
channel's state trees and modifies them. The modified trees have a root
hash. It might be:</p>
<ul>
<li>equal to the <code>state_hash</code> provided in the force progress transaction.
  This hash indeed is the expected result of the contract call and the
  blockchain has confirmed it. The on-chain channel object is updated
  accordingly:</li>
<li>channel's state hash is updated to be the newly computed one</li>
<li>channel's round is the one in the force progress transaction</li>
<li>if the channel had been in a closing state, closing balances of
    participants are updated according to the ones in the modified channel state
    trees</li>
<li>not equal to the <code>state_hash</code> provided in the force progress transaction. The
  hash provided was not confirmed to be the expected one. In this case the force
  progress fails and no new state channel state is created. The on-chain channel
  object is NOT modified and thus - the <code>round</code> and <code>state_hash</code> as stored
  on-chain remain unchanged. Gas is still consumed and a call object is created
  on-chain.</li>
</ul>
<p>A special case would be the forcer providing an invalid update call to be
forced. Examples for an invalid update calls would be:</p>
<ul>
<li>A remote call to a missing contract</li>
<li>Spending too much coins in the call so a participants's off-chain balance
  goes bellow the <code>channel_reserve</code> threshold</li>
<li>Contract call being terminated due to a <code>out_of_gas</code> exception</li>
</ul>
<p>In this case the contract can not be executed and the forcing of progress
fails to produce a new state. The end result is exactly the same as if there
had been a mismatch of the produced <code>state_hash</code> and the expected one. It is
worth mentioning that in this case the transaction is still a valid one, the
poster of the transaction is charged for the consumed gas.</p>
<h5 id="call-object">Call object</h5>
<p>If the <code>channel_force_progress_tx</code> is valid, the contract call in the <code>update</code>
is executed upon the MPT that had been produced by the <code>offchain_trees</code>.
The output is a new MPT that will represent the new off-chain channel state.
Participants are to either continue using the channel or close it. If there is
no later off-chain update, they are expected to use this produced MPT in both
cases.</p>
<p>The contract execution consumes gas. The <code>update</code> itself defines both the gas
limit and the gas price. After the contract call has been executed and the real
gas consumption has been calculated, the balance of the account posting the
transaction is updated to pay the gas fee. Since this is not a mutual
transaction but rather a unilateral one, the initiator of the progress
enforcement pays the fees.</p>
<p>The contract call produces on-chain a new call object in the on-chain state
trees for contract calls. Usually calls have a key that is composed by the
contract's address, the caller's address and the caller's nonce. Since the off-
chain contract is not persisted on-chain, it does not have an address that can
be used in that manner. The calls produced by forcing progress use the
<code>channel_force_progress_tx</code>'s hash instead.</p>
<p>Since the miner is expending resources for the contract's execution, the gas
fees are paid and the call object is created for every force progress, no matter
if it was successful to update the on-chain channel object or not.</p>
<h2 id="disputing-updates">Disputing updates</h2>
<p>Disputes should be considered anomalies, which only happen whenever one party
tries to unilaterally publish an outdated state while:</p>
<ul>
<li>closing a channel unilaterally</li>
<li>forcing progress</li>
<li>slashing</li>
<li>snapshoting</li>
</ul>
<p>and can be disputed via <code>channel_slash_tx</code>, <code>channel_force_progress_tx</code>,
<code>channel_snapshot_solo_tx</code> transactions.</p>
<p>Since disputes can themselves be challenged, we could end up in situations,
where a malicious party progresses rounds rapidly via <code>channel_force_progress_tx</code>
transactions, depriving the other party of the ability to dispute. To prevent
this situation we can either:</p>
<ol>
<li>enforce each dispute to always have to wait for the <code>lock_period</code> to expire
   and have only one dispute per period</li>
<li>or not restrict the number consecutive disputes but always have the option of
   challenging the first element of any chain of disputes, invalidating the full
   chain.</li>
</ol>
<p>We choose to use the second strategy because it allows faster progress in the
case of a peer that disappeared while still guaranteeing safety. This makes
keeping track of the proper states more complex but we assume a peer
disappearing has a higher likelihood than them being actively malicious.
Therefore we try to optimise for that case.</p>
<h3 id="force-progress-dispute-with-closing-channel">Force progress dispute with closing channel</h3>
<p>If the channel is in the closing state, which only happens via a
<code>channel_close_solo</code>, then each dispute triggers an extension of the channel
lock by <code>lock_period</code> blocks. If a channel is locked, the same rules as above
apply. That is, as many <code>channel_force_progress_tx</code> or <code>channel_slash_tx</code>
transactions as desired can be submitted—each one extending the lock—but as long
as the channel is locked, the entire chain can be invalidated if a state with a
higher round number can be posted.</p>
<p>Having the lock is necessary here because otherwise a malicious party might post
a <code>channel_force_progress_tx</code> or <code>channel_slash_tx</code> containing an outdated state
and then immediately try to have the channel be settled based on the result.</p>
<h3 id="force-progress-dispute-with-open-channel-example">Force progress dispute with open channel example</h3>
<p>Setup:</p>
<ul>
<li>Bob and Alice open a channel between each other with <code>lock_period := 100</code></li>
<li>At <code>chain_height := 1000</code> Bob posts a <code>channel_force_progress_tx</code> with a
  payload containing <code>round := 23</code> and  produces <code>round := 24</code> on chain</li>
<li>The channel state will now contain 23 as the latest <code>round</code> and 24 as
  the <code>solo_round</code></li>
</ul>
<p>With the selected strategy, Bob does not have to wait for the <code>lock_period</code> to
expire and can post as many <code>channel_force_progress_tx</code> as he wants, e.g. at
<code>chain_height := 1001</code> he produces <code>solo_round := 25</code> and by <code>chain_height := 1011</code>
arrives at <code>solo_round := 31</code>. The <code>round</code> is still at 23.</p>
<p>Now if Alice returns at <code>chain_height := 1110</code>, she can still dispute the
<em>initial</em> update issued by Bob at <code>chain_height := 1000</code> by providing an
authenticated by both payload with <code>round := 24</code> or higher via either a
<code>channel_force_progress_tx</code> or a <code>channel_snapshot_solo_tx</code>.</p>
<h3 id="force-progress-dispute-with-closing-channel-example">Force progress dispute with closing channel example</h3>
<p>Setup:</p>
<ul>
<li>Bob and Alice open a channel between each other with <code>lock_period := 100</code></li>
<li>At <code>chain_height := 1000</code> Bob posts a <code>channel_close_solo</code> with a
  payload containing <code>round := 23</code>. The channel is now locked until
  <code>chain_height == 1100</code></li>
</ul>
<p>With the selected strategy, Bob has to wait for the <code>lock_period</code> to expire, if
he wants to settle the channel. But while the channel is locked, he can still
post as many <code>channel_force_progress_tx</code> as he wants, e.g. at
<code>chain_height := 1001</code> he produces <code>solo_round := 24</code> and by <code>chain_height := 1011</code>
arrives at <code>solo_round := 31</code>. Each subsequent operation issued bumps the
<code>lock_period</code> ahead. That is, by <code>chain_height == 1011</code> the <code>lock_period</code> is set
to run out at <code>chain_height == 1111</code>.</p>
<p>Now it is important to note, that at even at <code>chain_height := 1110</code> Alice can
still dispute the <em>initial</em> update issued by Bob at <code>chain_height := 1000</code> by
providing an authenticated by both payload with <code>round := 24</code> or higher but her
dispute would bump the lock by <code>lock_period</code> too.</p>
<h3 id="channel-slash">Channel slash</h3>
<p>If a malicious party sent a <code>channel_close_solo</code> or <code>channel_force_progress_tx</code>
with an outdated state, the honest party has the opportunity to issue a
<code>channel_slash_tx</code> transaction. This transaction MUST include a state with a higher
<code>round</code> number than the one being disputed, authenticated by all peers for a
successful challenge.</p>
<p>Serialization defined <a href="../serializations.html#channel-slash-transaction">here</a></p>
<ul>
<li><code>channel_id</code>: channel id as recorded on-chain</li>
<li><code>from_id</code>: channel participant or delegate that posts the slashing transaction</li>
<li><code>payload</code>: an off-chain transaction proving that the proof of inclusion is part
  of the channel</li>
<li><code>poi</code>: proof of inclusion</li>
<li><code>ttl</code>: blockheight target until which this transaction can be included</li>
<li><code>fee</code>: transaction fee</li>
<li><code>nonce</code>: taken from the <code>from_id</code>'s account</li>
</ul>
<p>The proof of inclusion represents the channel's internal state. It has to
include both participants' accounts and their balances.
If there are any contracts in the channel and those have balances of their own,
they are not provided in the proof of inclusion but they are rather to be force
pushed in subsequent transactions. It is up to participants to decide if they
want to post them at all. Thus the accumulative balances of the accounts in the
slash transaction can be lower than the channel balance persisted on-chain.</p>
<h4 id="off-chain-transaction-payload_2">Off-chain transaction payload</h4>
<p>The payload is a transaction and it MUST be a <code>channel_offchain_tx</code>. It
MUST be authenticated by both peers.</p>
<p>Payload is a valid transaction that has:</p>
<ul>
<li><code>state_hash</code> equal to the proof of inclusion's root hash. This is a proof
  that the PoI is correct</li>
<li><code>channel_id</code> being the same as the transaction <code>channel_id</code></li>
<li><code>round</code> greater than the last on-chain provided co-authenticated channel
  state. If the latest on-chain round(s) were produced by
  <code>channel_force_progress_tx</code> transaction(s) that were based on an older channel
  state - the whole chain of forced progressed channel states are invalidated
  and replaced by the state provided by the slash. Co-authenticated channel
  transactions replace unilateral ones with the same round.</li>
</ul>
<p>If true, the following changes will be made:</p>
<ul>
<li><code>Channel(channel_id).round := payload.round</code></li>
<li><code>Channel(channel_id).solo_round := payload.round</code></li>
<li><code>Channel(channel_id).state_hash := payload.state_hash</code></li>
<li><code>Channel(channel_id).locked_until := Block.height + Channel(channel_id).lock_period</code></li>
</ul>
<h4 id="requirements_3">Requirements</h4>
<p>MUST be authenticated using the method corresponding to the public key <code>from_id</code>.</p>
<h2 id="channel-state-tree">Channel state tree</h2>
<p>Each block MUST commit to a Merkle Patricia tree of open channels, where the
<code>channel_id</code> specifies the path.
At a leaf, nodes store information pertaining to the current state of the given
channel.</p>
<ul>
<li><code>channel_id</code></li>
<li><code>initiator_id</code></li>
<li><code>responder_id</code></li>
<li><code>delegator_ids</code></li>
<li><code>total_amount</code></li>
<li><code>initiator_amount</code></li>
<li><code>responder_amount</code></li>
<li><code>channel_reserve</code></li>
<li><code>state_hash</code>: last published state_hash</li>
<li><code>round</code>: last known round</li>
<li><code>solo_round</code>: last round produced via a <code>channel_force_progress_tx</code></li>
<li><code>lock_period</code>: agreed upon locking period by peers</li>
<li><code>locked_until</code>: on-chain channel height after which the channel can be settled</li>
<li><code>initiator_auth</code>: (from Fortuna release) signing/authentication data for initiator</li>
<li><code>responder_auth</code>: (from Fortuna release) signing/authentication data for responder</li>
</ul>
<p>Keeping track of the <code>state_hash</code>, <code>round</code>, <code>locked_until</code>, and <code>lock_period</code> is
necessary for nodes to be able to assess the validity of <code>channel_slash_tx</code> and
<code>channel_settle_tx</code> transactions.</p>
<p>The <code>locked_until</code> is initialised with <code>0</code> and will stay <code>0</code> until the channel
enters the <code>closing</code> state.</p>
<p>Serialization defined <a href="../serializations.html#channel">here</a></p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="index.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: General" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              General
            </div>
          </div>
        </a>
      
      
        
        <a href="OFF-CHAIN.html" class="md-footer__link md-footer__link--next" aria-label="Next: Off-Chain Actions" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Off-Chain Actions
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["content.tabs.link", "search.highlight", "search.share", "search.suggest"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.477d984a.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.82b56eb2.min.js"></script>
      
    
  </body>
</html>